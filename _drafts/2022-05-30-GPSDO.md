---
layout: post
title: GPSDO
date:  2022-05-09 00:00:00 -1000
categories:
---

* TOC
{:toc}

# Potential Feature Set

* Output dejittered PPS
* Multiple OXCO support to compare
* DAC control + PWM control to compare
* Microcontroller control
* Various temperature sensors on OCXO, inside enclosure, outside temp

Different approaches:
* FLL
    * Measure number of pulses between PPS pulses.
    * Average...
    * Adjust control voltage
    * Benefit: 
	* works where there's a large frequency difference between
	  reference and output
	* should have a much lower time constant?
    * Disadvantage: 
	* slippage doesn't get corrected later on.
    * [How a Frequency Locked Loop (FLL) Works](https://wirelesspi.com/how-a-frequency-locked-loop-fll-works/)
	* CFO: carrier frequency offset
	* article not really relevant?
    * PLL lock implies FLL lock, but not the opposite.
	* frequency is the time derivative of phase

	    When phase goes up at a steady rate, the frequency is constant.

    * edn: [Frequency and Phase Locked Loops](https://www.edn.com/frequency-and-phase-locked-loops-pll/)
	* Patent of some logic that has both frequency and phase detector
    * esa: [Frequency Lock Loop (FLL)](https://gssc.esa.int/navipedia/index.php/Frequency_Lock_Loop_(FLL))
    * https://hal.archives-ouvertes.fr/hal-00255726v2/document: 
      *Note that the stability of the PLL is also usually much more difficult to obtain than with an FLL. 
       This is due to the “integrator” that naturally appears in the PLL structure.*
    * [PLL - why compare phases not frequencies](https://electronics.stackexchange.com/questions/34587/pll-why-compare-phases-not-frequencies)

	> Equivalently, phase is the time integral of frequency. So, when a phase detector is 
	> used to control frequency via a VCO, there is an integration around the loop. 
        > Or, roughly speaking, a low-pass filtering effect.

	A VCO counts as an integrator.

    * check out difference bewteen type 1 and type 2 PLL
    * [Phase-Locked Loop Design Fundamentals](https://www.nxp.com/files-static/rf_if/doc/app_note/AN535.pdf)
    * [FIFO controlled loop, PLL, FLL or something else?](https://www.dsprelated.com/showthread/comp.dsp/110702-2.php#tabs1-chronological)

	Comment by Allan Herriman describes AUDIO_clkgen.

* PLL with XOR or 4046 phase detector
    * Divide down pulse output from GPS to make 50% duty cycle
    * Divide down 10MHz similarly
    * If only PPS available, then forced to always use a very high
      time constant.
    * ublox can have output that is a multiple of its internal 48MHz clock

* PLL with a TIC (Time Interval Converter)
    * Measure time from PPS to the next edge of the divided down 10MHz clock

# References

*  OCXO oscillators
    * OSC5A2B02
    * Isotemp 143-141
    * CTS 1960045
    * Morion MV89A
	* Double oven OCXO
        * Supposedly very good
        * Quite expensive on eBay
    * Efratom LPRO-101 Rubidium standard

* [Budget GPSDO - A Work in Progress](https://www.eevblog.com/forum/projects/budget-gpsdo-a-work-in-progress/)

    * Has a PDF file that explains things in detail.
    * Uses a PIC.
    * Info about clean power supply, links to power supply ripple measurement.

* [A portable 10 MHz Rubidium Frequency Reference using the FE-5680A](https://www.ka7oei.com/10_MHz_Rubidium_FE-5680A.html)

* Trimble GPSDO modules.
    * Integrated GPSDO. Not just an oscillator.
    * Types: Thunderbolt, 72345, 65256, ...
    * antenna input
    * pps out
    * 10MHz out
    * RS-232
    * ~$100+ on eBay for naked module. $150+ with enclosure, antenna, and power supply.
    * [Notes on Trimble Thunderbolt performance and modifications](http://www.ke5fx.com/tbolt.htm)

        * Replaces OCXO on a Thunderbolt with a better one.

* TIC:
    * TI TDC7200
	* measures times from 12ns to 500ns. Resolution: 55ps
	* Example: [GPSDO Design: The TIC](https://hackerstuebchen.de/gpsdo-design-the-tic)
        * [Discussion about this design on eevblog](https://www.eevblog.com/forum/projects/diy-gpsdo-project-w-stm32-tdc7200/).
    * In Lars' design: 
	* HC390 used to divide 10MHz down to 1MHz. 
	* Use 4046 to create pulse between 0 and 1us.
	* Pulse into RC circuit -> digital to analog
	* Go to Arduino analog input.
    * Brooke Shera also uses a TIC.

* [Lady Heather's Disciplined Oscillator Control Program](http://www.ke5fx.com/heather/readme.htm)
    * Windows program to control various GPSDOs

* Sinewave Squarer
    * https://www.eevblog.com/forum/projects/diy-gpsdo-project-w-stm32-tdc7200/msg2833440/#msg2833440 

**Products**


* [Leo Bodnar - Precision GPS Reference Clock](http://www.leobodnar.com/shop/index.php?main_page=product_info&cPath=107&products_id=234)
  
    Uses [Si5328 Synchronous Ethernet Jitter-Attenuating Clock Multiplier](https://www.mouser.com/datasheet/2/368/Si5328-1397980.pdf)
    to create clocks between 450Hz and 800MHz.

    * [Eevblog teardown discussion](https://www.eevblog.com/forum/metrology/leo-bodnar-mini-precision-gps-reference-clock-teardown/)
        * Lots of interesting information, comparisons with other GPSDO etc.
    * Has 2 clock outputs (programmable frequency), but both outputs are derived from a common VCO.
    * Uses u-blox M8 module
    * Supposedly very low phase noise.
        * Much lower phase noise than a BG7TBL GPSDO.
    * The PCB has a cutout around TCXO (see teardown.) According to Leo this reduces the rate of frequency change and makes it easier
      to follow the drift.

    * [Investigation of Leo Bodnar GPSDO](http://www.leobodnar.com/files/Microsoft%20Word%20-%20Investigation%20of%20Leobodnar%20GPSDO_rev2.pdf)
    * [An Informal Evaluation of a Leo Bodnar GPS Frequency Reference](http://www.leobodnar.com/files/Informal%20Evaluation%20of%20a%20Leo%20Bodnar%20GPS%20Frequency%20Reference.pdf)

* [Leo Bodnar - Mini Precision GPS Reference Clock](https://www.leobodnar.com/shop/index.php?main_page=product_info&cPath=107&products_id=301)
    
    * Has 1 clock output instead of 2.
    * Any other differences compared ot the Precision version?

* [HP Z3801A / HP Z3816A GPSDO](http://www.realhamradio.com/GPS_Frequency_Standard.htm)

**Various builds - Traditional Analog PLL**

* [Probably the Simplest GPS Disciplined Oscillator possible](https://www.sdradio.eu/g4jnt/gpsdo.html)

    * Starts with an explanation about jitter on 1pps signals and long averaging times/time constants.
      And because of that, the oscillator needs to be stable for the duration of this time constant as well.
    * Uses a Jupiter-T module with 10kHz output.
        * Decent quality. No major detectable components in the
          sub Hz range.
    * Because of relatively high but stable 10kHz signal, can use a very simple traditional analog PLL
      with time constant of a few tens of seconds.
    * Uses a cheap VTCXO with 5MHz output.
    * Very bare bones without any way to read NMEA,  no good lock indication, no microcontroller, etc.
    * Some test results with [Argo - a DFCW and QRSS viewer](http://www.weaksignals.com/)
    * Not super stable: varies by a few Hz and wanders around the mean over a period of ~30 seconds.
        * Expected given the time constant.

* [Simple GPS Stabilised 10 MHz Oscillator](http://jrmiller.online/projects/ministd/frqstd0.htm)

    * Uses a Jupiter-T module
    * 5MHz OSC
    * Uses an Isotemp OCXO 124-10

* [VHF Communications - A GPS controlled frequency standard](http://www.vhfcomm.co.uk/GPS%20control.pdf)

    * Pretty much the same design as the one above.

* [Ein genaues und  stabiles 10 MHz Frequenznormal mit Ofen-Quarzoszillator (OCXO)](https://www.dl4zao.de/projekte/index.html#a1968)

    * PDF file... in German. Detailed description.
    * Uses Neo board with PPS output programmed to 100kHz (other other values) 
    * 74HC7046A phase comparator, standard RC LPF to control OCXO input.
    * Multiple output fanout board
    * Uses generic VC-OCXO: Bliley NV47, ENE 3311B, CTI OSC5A2B02


**Various builds - TIC + Microcontroller**

* [Lars DIY GPSDO with Arduino and 1ns resolution TIC](https://www.eevblog.com/forum/projects/lars-diy-gpsdo-with-arduino-and-1ns-resolution-tic/)

    * Uses a TIC: time-interval converter with ~1ns accuracy 
	* Fine grain is done with HC390 divider and 4046 to create a pulse that goes into an RC
	  to create analog. ADC of Arduino is used to read out.
	* Coarse grain is down by Arduino timer.
    * Uses PLL, implemented with an Arduino.
    * 16-bit DAC built with 2 8-bit PWM counters.
    * TIC and DAC capacitors need to be temperature stable type.
    * [A New High-Performance GPSDO](https://www.qsl.net/zl1bpu/PROJ/NGPSDO/New%20GPSDO.htm)
	    Implements Lars' design.

* [A high precision 10MHz GPS disciplined oscillator (GPSDO)](https://www.paulvdiyblogs.net/2020/07/a-high-precision-10mhz-gps-disciplined.html?m=1)

    * Implements Lars' design.
    * Excellent description, goes into a lot of detail to identify cause of inaccuracies.
    * Spends a lot of time and effort on temperature regulation.
    * Talks about different ublox modules.
    * Compares different OCXOs.

* [A SIMPLE GPS DISCIPLINED REFERENCE](https://www.qsl.net/zl1bpu/MICRO/SIMPLE/SimpleGPS.htm)

    * Uses an ATTINY to operate everything.
    * Clock of ATTINY is the 10MHz OSC clock itself: goes into the XTAL input.
    * 1pps input also goes straight into the ATTINY.
    * Everyting is done in software, with interrupts and overflow counters.
    * Has real RS232 for telemetry info.
    * RAKON OCXO (obsolete)

*  [Yet Another DIY GPSDO](https://www.eevblog.com/forum/projects/yet-another-diy-gpsdo-yes-another-one/)

    * Initially implemented an FLL, but also has a PLL option.
    * Frequency counter input.
    * Or TIC: measure delta time between incoming and generated 1pps signals with FF, RC filter, and MCU ADC.
    * Uses 12-bit I2C DAC or PWM to control OCXO.
    * Uses STM32F411 MCU
    * Lots of extra options that I should add: atmospheric pressure, temperature, humidity, current/voltage sensors
    * UTC aligned 1 pps output
    * Project repo: [STM32 GPSDO](https://github.com/AndrewBCN/STM32-GPSDO)
        * [Schematic](https://github.com/AndrewBCN/STM32-GPSDO/blob/main/schematics/GPSDO-KiCad.pdf)


---

* [Simple GPS Disciplined 10MHz Reference uses Dual PWMs](https://www.edn.com/simple-gps-disciplined-10mhz-reference-uses-dual-pwms/)

    * EDN website is horrible.
    * Arduino as controller.
    * Probably not very accurate due to non-use of fractional PWMs.
    * Uses VCXO, not an OCXO.

* [Remote GPSDO Hardware](https://f1atb.fr/index.php/2021/07/27/remote-gpsdo-hardware/)

    * Uses an Si5351A oscillator chip instead of an OXCO.
    * Generates a clock from 25kHz to 200MHz.
    * Clock generation is remote controlled.

* [An Arduino-based GPS Disciplined Oscillator](https://k6jca.blogspot.com/2016/02/an-arduino-based-gps-disciplined.html)

    * Uses an FLL, not a PLL.
    * Still has lots of info and some measurements.

* [A Simplified GPS-Derived Frequency Standard](http://ve2zaz.net/GPS_Std/Downloads/VE2ZAZ_GPS_Derived_Std_QEX_09_10_2006.pdf)

    * Uses a PIC controller.
    * FLL implementation.

* [GPSDO : GPS Disciplined Oscillator](https://www.vk4adc.com/web/index.php/general-projects/34-frequency-stabilisation/140-gpsdo-project)

    * A bit scrappy, but I should read it...

* [Simple GPS Freq. Ref.](http://www.hanssummers.com/gpsref2.html)

* [GPSDO YT 10 Mhz Lcd 2x16 With LED, UTC Time and GPS Localisation](https://www.instructables.com/GPSDO-YT-10-Mhz-Lcd-2x16-With-LED/)

* [Building a 10MHz GPS Disciplined Oscillator (GPSDO) using the Trimble Thunderbolt](https://w6aer.com/10mhz-gps-disciplined-oscillator-gpsdo-trimble-thunderbolt/)

    * Starts out with a Trimble Thunderbolt, which is ready-made GPSDO.
    * Focuses on all the rest: power supply etc. 

* [Tiny GPSDO](https://www.instructables.com/Tiny-GPSDO/)

    * On instructables.
    * "incomplete - need new PCB"
    * 10 outputs
    * Uses Neo 7 and Trimble OCXO
    * Uses 74HC4046 as phase comparator


* [Simulating the Brooks Shera (W5OJM) GPSDO Algorithm](https://k6jca.blogspot.com/2018/12/simulating-brooks-shera-w5ojm-gpsdo.html)

* [Making a Rubidium GPSDO](https://hackerstuebchen.de/making-a-rubidium-gpsdo)



* [GPS Disciplined Oscillator](https://attila.kinali.ch/blog/2016/02/07/gps-disciplined-oscillator)

    * Just a list with different GPSDO builds, some of which are listed above.


# General Articles

* [The Use of GPS Disciplined Oscillators as Primary Frequency Standards for Calibration and Metrology Laboratories](https://tf.nist.gov/general/pdf/2297.pdf)

* [Time-nuttery 101](https://www.efos3.com/TimeNut.html)
